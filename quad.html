<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quad-Viewer</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link href="color-picker.min.css" rel="stylesheet">
</head>

<body>
    <h3>TCGA Segmentation Data</h3>

    <div id="selections"></div>
    <div><br>&nbsp;</div>
    <div id="viewers" class="container"></div>

    <!-- <script src="jquery-1.12.4.min.js"></script> -->
    <script src="//openseadragon.github.io/openseadragon/openseadragon.min.js"></script>
    <script src="openseadragon/openseadragon-filtering.js"></script>
    <script src="openseadragon/viewerinputhook.js"></script>
    <script src="openseadragon/openseadragon-fabricjs-overlay.js"></script>
    <script src="openseadragon/fabric.adapted.js"></script>
    <script src="map-marker.js"></script>
    <script src="dropdown.js"></script>
    <script src="toggle.js"></script>
    <script src="color-picker.min.js"></script>
    <script src="color.js"></script>
    <script src="paint.js"></script>
    <script src="toolbar.js"></script>
    <script src="nViewer.js"></script>
    <script src="synchronizer.js"></script>
    <script>
        const arr = [];
        const style = "dragonbox";
        // const iiif = "https://quip.bmi.stonybrook.edu/iiif/?iiif=/tcgaseg";
        const iiif = window.location.origin + "/iiif/?iiif=/tcgaseg";
        const id = "blca/TCGA-2F-A9KO-01Z-00-DX1.195576CF-B739-4BD9-B15B-4A70AE287D3E";

        const num_viewers = 4;
        for (let i = 0; i < num_viewers; i++) {
            let v = new nViewer("viewer" + i, style);
            // console.log("v instanceof nViewer", (v instanceof nViewer)) TRUE.
            arr.push(v);
        }

        new Dropdown(arr);

        function test() {
            // TESTING
            let highsmith = "//openseadragon.github.io/example-images/highsmith/highsmith.dzi";
            arr.forEach(function (elem) {
                // console.log("elem instanceof nViewer", (elem instanceof nViewer)) TRUE
                // elem.getViewer().openDzi(highsmith);
                elem.getViewer().open(highsmith)
            });
        }

        function live() {
            // FOR REAL
            arr.forEach(function (elem) {
                // console.log("elem instanceof nViewer", (elem instanceof nViewer)) TRUE
                elem.setSources([iiif + "/tcgaimages/" + id + ".svs/info.json",
                iiif + "/featureimages/" + id + "-featureimage.tif/info.json"],
                    [1.0, 1.0]);
            });
        }

        test();
        // live();

        sync = new Synchronizer(arr);  // Pass an array of nViewers

        // $("mark").on('DOMSubtreeModified', function () {
        //   console.log("Mark HTML is now " + $(this).html());
        // });

    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCGA Segmentation Data</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/scroll_menu.css">
    <link href="./js/vendor/color-picker/color-picker.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./js/vendor/font-awesome-4.7.0/css/font-awesome.min.css" />
</head>

<body>
    <h3>TCGA Segmentation Data</h3>

    <div id="selections"></div>
    <div><br>&nbsp;</div>
    <div id="viewers" class="container"></div>

    <script src="./js/vendor/openseadragon/openseadragon.js"></script>
    <script src="./js/vendor/fabric/openseadragon-fabricjs-overlay.js"></script>
    <script src="./js/vendor/jquery-3.5.1.min.js"></script>
    <script src="./js/vendor/fabric/fabric.adapted.js"></script>
    <script src="./js/vendor/openseadragon/openseadragon-filtering.js"></script>
    <script src="./js/vendor/openseadragon/viewerinputhook.js"></script>
    <script src="./js/vendor/openseadragon/imaginghelper.js"></script>
    <script src="./js/dropdown.js"></script>
    <script src="./js/map-marker.js"></script>
    <script src="./js/vendor/color-picker/color-picker.min.js"></script>
    <script src="./js/color.js"></script>
    <script src="./js/markupTools.js"></script>
    <script src="./js/toolbar.js"></script>
    <script src="./js/nViewer.js"></script>
    <script src="./js/synchronizer.js"></script>

    <script>
        // Variables
        const arr = [];
        const style = "dragonbox";
        const iiif = window.location.origin + "/iiif/?iiif=/tcgaseg";
        const id = "blca/TCGA-2F-A9KO-01Z-00-DX1.195576CF-B739-4BD9-B15B-4A70AE287D3E";
        const options = {
            filterOn: true,
            slidersOn: true,
            toolbarOn: false,
            multipleOn: false,
            paintbrushColor: "#0ff"
        };

        // Create viewer(s)
        const num_viewers = 1;
        for (let i = 0; i < num_viewers; i++) {
            let v = new nViewer("viewer" + i, style, "viewers", options);
            arr.push(v);
        }

        // Add dropdown to the page
        // (Now that we have 1 or more viewers created)
        new Dropdown(arr, 'selections', './json/tcga.json');

        function test() {
            // TESTING
            let dzi = "//openseadragon.github.io/example-images/duomo/duomo.dzi";
            arr.forEach(function (elem) {
                elem.getViewer().open(dzi)
            });
        }

        function live() {
            // Set viewer source
            arr.forEach(function (elem) {
                elem.setSources([iiif + "/tcgaimages/" + id + ".svs/info.json",
                iiif + "/featureimages/" + id + "-featureimage.tif/info.json"],
                    [1.0, 1.0]);
            });
        }

        // test();
        live();

        // Controller to keep viewers in sync
        sync = new Synchronizer(arr);  // Pass an array of nViewers

    </script>

</body>

</html>
